
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Overview &#8212; pyodine</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Code structure" href="code_structure.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="overview">
<span id="id1"></span><h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="create-a-deconvolved-stellar-template">
<h2>Create a deconvolved stellar template<a class="headerlink" href="#create-a-deconvolved-stellar-template" title="Permalink to this headline">¶</a></h2>
<p>To create a deconvolved stellar template, you can use the <code class="docutils literal notranslate"><span class="pre">pyodine_create_templates.create_template()</span></code> function:</p>
<dl class="py function">
<dt id="pyodine_create_templates.create_template">
<code class="sig-prename descclassname">pyodine_create_templates.</code><code class="sig-name descname">create_template</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">utilities</span></em>, <em class="sig-param"><span class="n">Pars</span></em>, <em class="sig-param"><span class="n">ostar_files</span></em>, <em class="sig-param"><span class="n">temp_files</span></em>, <em class="sig-param"><span class="n">temp_outname</span></em>, <em class="sig-param"><span class="n">plot_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">res_files</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodine_create_templates.create_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a deconvolved stellar template</p>
<p>This routine takes a list of hot star observations, which are modelled
with the I2 template and LSF. The best-fit parameters (mainly LSF) are then
used to deconvolve the stellar template observation(s), resulting in a
high-S/N, oversampled stellar template for later observation modelling of
the same star.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utilities</strong> (<em>library</em>) – The utilities module for the instrument used in this 
analysis.</p></li>
<li><p><strong>Pars</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Template_Parameters</span></code>) – The parameter input object to use.</p></li>
<li><p><strong>ostar_files</strong> (<em>str</em><em> or </em><em>list</em>) – A pathname to a text-file with pathnames of hot star 
observations for the modelling, or, alternatively, a list with the 
pathnames.</p></li>
<li><p><strong>temp_files</strong> (<em>str</em><em> or </em><em>list</em>) – A pathname to a text-file with pathnames of stellar 
template observations to use, or, alternatively, a list with the 
pathnames.</p></li>
<li><p><strong>temp_outname</strong> (<em>str</em>) – The pathname where to save the deconvolved stellar 
template. If the directory structure does not exist yet, it will be 
created in the process.</p></li>
<li><p><strong>plot_dir</strong> (<em>str</em><em> or </em><em>None</em>) – The directory name where to save plots and modelling 
results. If the directory structure does not exist yet, it will be 
created in the process. If None is given, no results/plots will be 
saved (default).</p></li>
<li><p><strong>res_files</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>None</em>) – A pathname to a text-file with pathnames under which to 
save the results file(s), or, alternatively, a list with the 
pathname(s). If you want to save results from multiple runs, you should 
supply pathnames for each run. If the directory structure does not 
exist yet, it will be created in the process. If None is given, no 
results will be saved (default).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="model-a-single-observation">
<h2>Model a single observation<a class="headerlink" href="#model-a-single-observation" title="Permalink to this headline">¶</a></h2>
<p>After you have created a deconvolved stellar template, you can use it to model an observation of the same star, obtained <strong>WITH</strong> the I2 cell in the light path. This is done with the function <code class="docutils literal notranslate"><span class="pre">pyodine_model_observations.model_single_observation()</span></code>:</p>
<dl class="py function">
<dt id="pyodine_model_observations.model_single_observation">
<code class="sig-prename descclassname">pyodine_model_observations.</code><code class="sig-name descname">model_single_observation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Pars</span></em>, <em class="sig-param"><span class="n">obs_file</span></em>, <em class="sig-param"><span class="n">temp_file</span></em>, <em class="sig-param"><span class="n">iod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orders</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tellurics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">res_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodine_model_observations.model_single_observation" title="Permalink to this definition">¶</a></dt>
<dd><p>Model a single observation</p>
<p>This routine models a stellar observation spectrum with I2, using a stellar
template spectrum, I2 template and LSF model. The modelling can be
performed in multiple runs, in order to allow a better determination of the
fit parameters. The results and analysis plots can be saved to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Pars</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>) – The parameter input object to use.</p></li>
<li><p><strong>obs_file</strong> (<em>str</em>) – The pathname of the stellar observation to model.</p></li>
<li><p><strong>temp_file</strong> (<em>str</em>) – The pathname of the deconvolved stellar template to use 
in the modelling.</p></li>
<li><p><strong>iod</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">IodineTemplate</span></code>, or None) – The I2 template to use in the modelling. If None, it is loaded 
as specified in the parameter input object.</p></li>
<li><p><strong>orders</strong> (<em>list</em><em>, </em><em>ndarray</em><em>, or </em><em>None</em>) – The orders of the observation to work on. If None, they are 
defined as specified by the template and the parameter input object.</p></li>
<li><p><strong>normalizer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleNormalizer</span></code>, or None) – The normalizer to use. If None, it is created as 
specified in the parameter input object.</p></li>
<li><p><strong>tellurics</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleTellurics</span></code>, or None) – The tellurics to use. If None, it is created as specified 
in the parameter input object.</p></li>
<li><p><strong>plot_dir</strong> (<em>str</em><em>, or </em><em>None</em>) – The directory name where to save plots. If the directory 
structure does not exist yet, it will be created in the process. If 
None is given, no plots will be saved (default).</p></li>
<li><p><strong>res_names</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>None</em>) – The pathname under which to save the results file. If you 
want to save results from multiple runs, you should supply a list with 
pathnames for each run. If the directory structure does not exist yet, 
it will be created in the process. If None is given, no results will be 
saved (default).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="model-multiple-observations">
<h2>Model multiple observations<a class="headerlink" href="#model-multiple-observations" title="Permalink to this headline">¶</a></h2>
<p>In many cases you will have more than one single observation of the same star that you want to model. Then you can take advantage of Python’s parallelizing capabilities and use the function <code class="docutils literal notranslate"><span class="pre">pyodine_model_observations.model_multi_observations()</span></code> to model the observations on several cores at the same time:</p>
<dl class="py function">
<dt id="pyodine_model_observations.model_multi_observations">
<code class="sig-prename descclassname">pyodine_model_observations.</code><code class="sig-name descname">model_multi_observations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Pars</span></em>, <em class="sig-param"><span class="n">obs_files</span></em>, <em class="sig-param"><span class="n">temp_files</span></em>, <em class="sig-param"><span class="n">plot_dirs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">res_files</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodine_model_observations.model_multi_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Model multiple observations at the same time</p>
<p>This function can parallelize the modelling of multiple observations,
taking advantage of Python’s <code class="xref py py-class docutils literal notranslate"><span class="pre">multiprocessing.Pool</span></code> capabilities.
The number of parallel processes is defined in the parameter input object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Pars</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>) – The parameter input object for the used instrument.</p></li>
<li><p><strong>obs_files</strong> (<em>str</em><em> or </em><em>list</em>) – A pathname to a text-file with pathnames of stellar 
observations for the modelling, or, alternatively, a list with the 
pathnames.</p></li>
<li><p><strong>temp_files</strong> (<em>str</em><em> or </em><em>list</em>) – A pathname to a text-file with pathnames of the 
deconvolved stellar templates to use for each of the observations, or, 
alternatively, a list with the pathnames.</p></li>
<li><p><strong>plot_dirs</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>None</em>) – A pathname to a text-file with directory names for each 
observation where to save plots, or, alternatively, a list with the 
directory names. If the directory structure does not exist yet, it will 
be created in the process. If None is given, no results/plots will be 
saved (default).</p></li>
<li><p><strong>res_files</strong> (<em>str</em><em>, </em><em>list</em><em>, or </em><em>None</em>) – A pathname to a text-file with pathnames under which to 
save the results file(s), or, alternatively, a list with the 
pathname(s). If you want to save results from multiple runs, you should 
supply pathnames for each run. If the directory structure does not 
exist yet, it will be created in the process. If None is given, no 
results will be saved (default).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyodine.plot_lib.plot_residual_hist">
<code class="sig-prename descclassname">pyodine.plot_lib.</code><code class="sig-name descname">plot_residual_hist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit_results</span></em>, <em class="sig-param"><span class="n">residual_arr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tellurics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">robust</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dpi</span><span class="o">=</span><span class="default_value">300</span></em>, <em class="sig-param"><span class="n">show_plot</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyodine.plot_lib.plot_residual_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a histogram of all chunk residuals (in percent)</p>
<p>If tellurics are given, both the complete residuals and those outside of 
the telluric regions are plotted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_results</strong> (list[<code class="xref py py-class docutils literal notranslate"><span class="pre">LmfitResult</span></code>]) – A list containing instances of <code class="xref py py-class docutils literal notranslate"><span class="pre">LmfitResult</span></code>
for each chunk.</p></li>
<li><p><strong>residual_arr</strong> (<em>tuple</em><em>, </em><em>list</em><em>, </em><em>ndarray</em><em>, or </em><em>None</em>) – If supplied, just use this data for the plot (if 
tuple: all residuals and sub residuals, otherwise just one array of 
residuals). If left free, calculate the data from fit_results.</p></li>
<li><p><strong>tellurics</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleTellurics</span></code> or None) – An instance of tellurics. If None, they are not included 
(default).</p></li>
<li><p><strong>robust</strong> (<em>bool</em>) – Whether to use the robust estimator for the residuals. 
Defaults to True.</p></li>
<li><p><strong>title</strong> (<em>str</em><em> or </em><em>None</em>) – A title for the plot. If None, a default title is used.</p></li>
<li><p><strong>savename</strong> (<em>str</em><em> or </em><em>None</em>) – If a pathname is given, the plot is saved there. Defaults 
to None.</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – DPI of the saved plot. Defaults to 300.</p></li>
<li><p><strong>show_plot</strong> (<em>bool</em>) – If True, the plot is showed during execution. Defaults 
to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The calculated residuals (either both all and sub, or only all).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple or ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">pyodine</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Quick start</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#create-a-deconvolved-stellar-template">Create a deconvolved stellar template</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-a-single-observation">Model a single observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-multiple-observations">Model multiple observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_structure.html">Code structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial/preparation.html">Prepare the environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/template.html">Create a deconvolved stellar template</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/observation.html">Model the stellar I2 observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/velocities.html">Weight and combine the chunk velocities</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="code_structure.html" title="next chapter">Code structure</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Heeren, Tronsgaard Rasmussen, Grundahl.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/overview.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>